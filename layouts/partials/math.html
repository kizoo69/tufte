<!-- MathJax 3: CDN primary, local fallback -->

<!-- MathJax configuration -->
<script>
MathJax = {
    tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        tags: 'ams'
    },
    options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
};
</script>

<!-- Local fallback function -->
<script>
function loadLocalMathJax() {
    var script = document.createElement('script');
    script.src = '{{ "/lib/mathjax/es5/tex-mml-chtml.js" | relURL }}';
    script.async = true;
    document.head.appendChild(script);
    console.log('MathJax CDN failed, loading local copy');
}
</script>

<!-- MathJax 3 from CDN, fallback to local on error -->
<script id="MathJax-script" async
    src="//cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"
    onerror="loadLocalMathJax()">
</script>
